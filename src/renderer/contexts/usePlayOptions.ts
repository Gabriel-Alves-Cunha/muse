import create from "solid-zustand";

import { setPlayOptionsOnLocalStorage } from "./localStorageHelpers";

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////
// Main:

export const usePlayOptions = create<PlayOptions>()(
	setPlayOptionsOnLocalStorage(() => ({ isRandom: false, loop: false })),
);

export const { getState: getPlayOptions, setState: setPlayOptions } =
	usePlayOptions;

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////
// Helper functions:

export function toggleLoopMedia(): void {
	const loop = !getPlayOptions().loop;

	(document.getElementById("audio") as HTMLAudioElement).loop = loop;

	setPlayOptions({ loop });
}

////////////////////////////////////////////////

export const toggleRandom = () =>
	setPlayOptions({ isRandom: !getPlayOptions().isRandom });

////////////////////////////////////////////////
////////////////////////////////////////////////
////////////////////////////////////////////////
// Types:

export type PlayOptions = Readonly<{ isRandom: boolean; loop: boolean }>;
